<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Bagging</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Bagging</h1>



<p>Description:</p>
<p>This function implements a generic bagging (Bootstrap Aggregating)
approach for various types of regularized regression models. Bagging
involves repeatedly sampling from the dataset with replacement, fitting
a model on each of these bootstrap samples, and then averaging the
results. This technique is intended to increase the stability and
accuracy of regression models by reducing variance without significantly
increasing bias. It is particularly useful for models that tend to
overfit or are sensitive to the specifics of the training data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(SimpleEnsembleGroup20)</span></code></pre></div>
<p>perform_bagging(y, X, model_type, alpha, lambda = NULL, R = 100)
Arguments: y: Numeric vector representing the response variable in the
regression model. X: Matrix or data frame of predictor variables.
model_type: A character string specifying the type of regression model
to fit. Supported options include “ridge”, “lasso”, “elastic_net”,
“svm”, “random_forest”. Each model type might have specific requirements
for the alpha and lambda parameters. alpha: Numeric, specifying the
mixing percentage between ridge (alpha = 0) and lasso (alpha = 1) for
elastic net models. Required for “ridge”, “lasso”, and “elastic_net”.
lambda: Optional numeric vector of regularization parameters to be used
in the model. If NULL, the optimal lambda is chosen using
cross-validation within each bootstrap sample. R: Integer, indicating
the number of bootstrap replicates to use in the bagging process.
Default is 100.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#&#39; Perform Bagging for Regression Models (excluding linear and logistic)</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&#39;With the exception of linear and logistic regression, this function offers a generic bagging approach for regression models.</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&#39;To increase the stability and accuracy of the model, it takes a dataset, samples it repeatedly using replacement, fits a model on each sample, and then averages the</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&#39;#&#39; results. It calculates variable relevance scores, t-values,</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&#39;#&#39; p-values, averaged coefficients, and standard errors.</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&#39; @param y Response vector with outcomes.</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&#39; @param X Predictor matrix or data frame.</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&#39; @param model_type The type of regression model to fit. Options: &quot;ridge&quot;, &quot;lasso&quot;, &quot;elastic_net&quot;, &quot;svm&quot;, &quot;random_forest&quot;.</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&#39; @param R The number of bootstrap replicates to use in the bagging process.</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&#39; @return A list containing:</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&#39;&#39;coefficients&#39;: Averaged coefficients across all bootstrap samples.</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&#39;&#39;se_coefficients&#39;: Standard errors of the averaged coefficients.</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&#39; &#39;t_values&#39;: t-values computed from averaged coefficients and their standard errors.</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&#39;   - &#39;p_values&#39;: p-values associated with the t-values.</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&#39;   - &#39;predictions&#39;: Averaged predictions across all bootstrap samples.</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&#39;   - &#39;variable_importance&#39;: Importance scores for each predictor, averaged across all samples.</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&#39; @examples</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&#39; # Example usage with Ridge Regression</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&#39; data(mtcars)</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&#39; results &lt;- perform_bagging(mtcars$mpg, mtcars[, -1], model_type = &quot;ridge&quot;, R = 100)</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&#39; print(results)</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co"># Define a Ridge Regression fitting function as an example</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co"># Define the generic bagging function for regularized regression models</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>perform_bagging <span class="ot">&lt;-</span> <span class="cf">function</span>(y, X, model_type, alpha, <span class="at">lambda =</span> <span class="cn">NULL</span>, <span class="at">R =</span> <span class="dv">100</span>) {</span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, {</span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>    indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(n), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>    <span class="co"># Determine lambda using cross-validation if not provided</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(lambda)) {</span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>      cv_fit <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(<span class="at">x =</span> X[indices, , <span class="at">drop =</span> <span class="cn">FALSE</span>], <span class="at">y =</span> y[indices], <span class="at">alpha =</span> alpha)</span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>      lambda <span class="ot">&lt;-</span> cv_fit<span class="sc">$</span>lambda.min</span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>    }</span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>    <span class="co"># Fit the model using the sampled indices</span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> X[indices, , <span class="at">drop =</span> <span class="cn">FALSE</span>], <span class="at">y =</span> y[indices], <span class="at">alpha =</span> alpha, <span class="at">lambda =</span> lambda)</span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a>    <span class="co"># Predict using the full dataset for consistency in output dimension</span></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a>    <span class="fu">predict</span>(fit, <span class="at">newx =</span> X, <span class="at">s =</span> lambda)</span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a>  }, <span class="at">simplify =</span> <span class="cn">FALSE</span>)  <span class="co"># Use simplify = FALSE to store results as a list</span></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a>  <span class="co"># Calculate mean and standard deviation across all bootstrap predictions</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>  pred_matrix <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, results)  <span class="co"># Bind all predictions into a matrix</span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a>    <span class="at">mean_prediction =</span> <span class="fu">rowMeans</span>(pred_matrix),</span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a>    <span class="at">sd_prediction =</span> <span class="fu">apply</span>(pred_matrix, <span class="dv">1</span>, sd)</span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a>  )</span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Example usage with the mtcars dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>mpg</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(mtcars[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co"># Ridge bagging (alpha = 0 for ridge regression)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>ridge_results <span class="ot">&lt;-</span> <span class="fu">perform_bagging</span>(y, X, <span class="at">model_type =</span> <span class="st">&quot;ridge&quot;</span>, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">R =</span> <span class="dv">50</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Ridge Regression Results:&quot;</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Ridge Regression Results:&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="fu">print</span>(ridge_results)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; $mean_prediction</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt;           Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;            21.98628            21.70499            26.75734            20.63836 </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt;   Hornet Sportabout             Valiant          Duster 360           Merc 240D </span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt;            16.77358            20.22571            14.00720            22.89357 </span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt;            Merc 230            Merc 280           Merc 280C          Merc 450SE </span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt;            23.84127            19.59124            19.77811            15.18899 </span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt;          Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental </span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt;            15.85889            15.89412            11.28403            10.95621 </span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt;   Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla </span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt;            11.18680            27.92173            29.12981            28.92389 </span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt;       Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 </span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt;            23.99802            16.51963            17.34981            14.08196 </span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt;    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa </span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt;            15.81180            28.21658            26.55648            27.36691 </span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt;      Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E </span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt;            18.78526            19.65362            13.67412            25.28002 </span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt; $sd_prediction</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="co">#&gt;           Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive </span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="co">#&gt;           0.4616934           0.4791546           1.3145824           0.9027410 </span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt;   Hornet Sportabout             Valiant          Duster 360           Merc 240D </span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co">#&gt;           0.8227658           0.9834654           0.6321582           0.9993312 </span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co">#&gt;            Merc 230            Merc 280           Merc 280C          Merc 450SE </span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="co">#&gt;           1.2187763           0.9910741           0.9803120           0.5645460 </span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co">#&gt;          Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental </span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="co">#&gt;           0.4838313           0.5106087           1.1995301           1.3073705 </span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="co">#&gt;   Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla </span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co">#&gt;           1.2698007           1.1942328           1.1429433           1.2682819 </span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="co">#&gt;       Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 </span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="co">#&gt;           0.9571370           0.7511910           0.7249688           0.7146037 </span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a><span class="co">#&gt;    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa </span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="co">#&gt;           0.8447052           1.1981746           1.0420592           1.4708966 </span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="co">#&gt;      Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E </span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="co">#&gt;           1.5809278           1.0420691           1.6842618           1.2311922</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="co"># Lasso bagging (alpha = 1 for lasso regression)</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a>lasso_results <span class="ot">&lt;-</span> <span class="fu">perform_bagging</span>(y, X, <span class="at">model_type =</span> <span class="st">&quot;lasso&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">R =</span> <span class="dv">50</span>)</span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Lasso Regression Results:&quot;</span>)</span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Lasso Regression Results:&quot;</span></span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a><span class="fu">print</span>(lasso_results)</span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a><span class="co">#&gt; $mean_prediction</span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a><span class="co">#&gt;           Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive </span></span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a><span class="co">#&gt;            22.02709            21.52243            26.14467            20.67961 </span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a><span class="co">#&gt;   Hornet Sportabout             Valiant          Duster 360           Merc 240D </span></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="co">#&gt;            17.40129            20.00191            15.09544            22.73182 </span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a><span class="co">#&gt;            Merc 230            Merc 280           Merc 280C          Merc 450SE </span></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a><span class="co">#&gt;            23.42655            19.41533            19.56028            15.19210 </span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a><span class="co">#&gt;          Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental </span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a><span class="co">#&gt;            16.09368            16.06484            11.58833            11.07481 </span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a><span class="co">#&gt;   Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla </span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a><span class="co">#&gt;            11.22602            27.08119            28.62749            28.22661 </span></span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a><span class="co">#&gt;       Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 </span></span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a><span class="co">#&gt;            24.09578            17.02969            17.67555            14.75751 </span></span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a><span class="co">#&gt;    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa </span></span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a><span class="co">#&gt;            16.35615            27.60872            26.51391            27.62745 </span></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a><span class="co">#&gt;      Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E </span></span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a><span class="co">#&gt;            19.01812            20.15056            14.55732            24.52103 </span></span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a><span class="co">#&gt; $sd_prediction</span></span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a><span class="co">#&gt;           Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive </span></span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a><span class="co">#&gt;           0.7036948           0.7513622           1.7236481           0.8195105 </span></span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a><span class="co">#&gt;   Hornet Sportabout             Valiant          Duster 360           Merc 240D </span></span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a><span class="co">#&gt;           0.7064896           1.0959036           1.0358067           0.8792127 </span></span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a><span class="co">#&gt;            Merc 230            Merc 280           Merc 280C          Merc 450SE </span></span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a><span class="co">#&gt;           1.7007125           0.8257233           0.7908825           0.9776668 </span></span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a><span class="co">#&gt;          Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental </span></span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a><span class="co">#&gt;           0.7094227           0.7397459           1.6032762           1.8054838 </span></span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a><span class="co">#&gt;   Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla </span></span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a><span class="co">#&gt;           1.8184667           1.6511611           1.4943521           1.7193533 </span></span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a><span class="co">#&gt;       Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 </span></span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a><span class="co">#&gt;           1.2679782           0.7301051           0.6302024           1.1172290 </span></span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a><span class="co">#&gt;    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa </span></span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a><span class="co">#&gt;           0.9321368           1.5134875           1.9438726           1.6678937 </span></span>
<span id="cb3-85"><a href="#cb3-85" tabindex="-1"></a><span class="co">#&gt;      Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E </span></span>
<span id="cb3-86"><a href="#cb3-86" tabindex="-1"></a><span class="co">#&gt;           2.8278933           0.8011956           1.1427797           1.6387192</span></span>
<span id="cb3-87"><a href="#cb3-87" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" tabindex="-1"></a><span class="co"># Elastic Net bagging (alpha between 0 and 1)</span></span>
<span id="cb3-89"><a href="#cb3-89" tabindex="-1"></a>elastic_net_results <span class="ot">&lt;-</span> <span class="fu">perform_bagging</span>(y, X, <span class="at">model_type =</span> <span class="st">&quot;elastic_net&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">R =</span> <span class="dv">50</span>)</span>
<span id="cb3-90"><a href="#cb3-90" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Elastic Net Regression Results:&quot;</span>)</span>
<span id="cb3-91"><a href="#cb3-91" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Elastic Net Regression Results:&quot;</span></span>
<span id="cb3-92"><a href="#cb3-92" tabindex="-1"></a><span class="fu">print</span>(elastic_net_results)</span>
<span id="cb3-93"><a href="#cb3-93" tabindex="-1"></a><span class="co">#&gt; $mean_prediction</span></span>
<span id="cb3-94"><a href="#cb3-94" tabindex="-1"></a><span class="co">#&gt;           Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive </span></span>
<span id="cb3-95"><a href="#cb3-95" tabindex="-1"></a><span class="co">#&gt;            22.28008            21.98847            26.36689            20.71864 </span></span>
<span id="cb3-96"><a href="#cb3-96" tabindex="-1"></a><span class="co">#&gt;   Hornet Sportabout             Valiant          Duster 360           Merc 240D </span></span>
<span id="cb3-97"><a href="#cb3-97" tabindex="-1"></a><span class="co">#&gt;            17.36911            20.14363            14.54379            22.41669 </span></span>
<span id="cb3-98"><a href="#cb3-98" tabindex="-1"></a><span class="co">#&gt;            Merc 230            Merc 280           Merc 280C          Merc 450SE </span></span>
<span id="cb3-99"><a href="#cb3-99" tabindex="-1"></a><span class="co">#&gt;            23.83125            19.29063            19.57533            15.38338 </span></span>
<span id="cb3-100"><a href="#cb3-100" tabindex="-1"></a><span class="co">#&gt;          Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental </span></span>
<span id="cb3-101"><a href="#cb3-101" tabindex="-1"></a><span class="co">#&gt;            16.22138            16.30190            11.93232            11.46296 </span></span>
<span id="cb3-102"><a href="#cb3-102" tabindex="-1"></a><span class="co">#&gt;   Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla </span></span>
<span id="cb3-103"><a href="#cb3-103" tabindex="-1"></a><span class="co">#&gt;            11.61094            27.69891            29.32547            28.92016 </span></span>
<span id="cb3-104"><a href="#cb3-104" tabindex="-1"></a><span class="co">#&gt;       Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 </span></span>
<span id="cb3-105"><a href="#cb3-105" tabindex="-1"></a><span class="co">#&gt;            23.86029            16.84706            17.81452            14.51880 </span></span>
<span id="cb3-106"><a href="#cb3-106" tabindex="-1"></a><span class="co">#&gt;    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa </span></span>
<span id="cb3-107"><a href="#cb3-107" tabindex="-1"></a><span class="co">#&gt;            16.39000            28.00760            26.21813            26.71754 </span></span>
<span id="cb3-108"><a href="#cb3-108" tabindex="-1"></a><span class="co">#&gt;      Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E </span></span>
<span id="cb3-109"><a href="#cb3-109" tabindex="-1"></a><span class="co">#&gt;            19.00745            19.44696            13.85657            24.92837 </span></span>
<span id="cb3-110"><a href="#cb3-110" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-111"><a href="#cb3-111" tabindex="-1"></a><span class="co">#&gt; $sd_prediction</span></span>
<span id="cb3-112"><a href="#cb3-112" tabindex="-1"></a><span class="co">#&gt;           Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive </span></span>
<span id="cb3-113"><a href="#cb3-113" tabindex="-1"></a><span class="co">#&gt;           0.9251700           0.8862938           1.6459466           0.9260826 </span></span>
<span id="cb3-114"><a href="#cb3-114" tabindex="-1"></a><span class="co">#&gt;   Hornet Sportabout             Valiant          Duster 360           Merc 240D </span></span>
<span id="cb3-115"><a href="#cb3-115" tabindex="-1"></a><span class="co">#&gt;           0.9071606           1.1711670           0.8823143           2.7209141 </span></span>
<span id="cb3-116"><a href="#cb3-116" tabindex="-1"></a><span class="co">#&gt;            Merc 230            Merc 280           Merc 280C          Merc 450SE </span></span>
<span id="cb3-117"><a href="#cb3-117" tabindex="-1"></a><span class="co">#&gt;           2.4807740           2.5614639           2.2235092           0.5311339 </span></span>
<span id="cb3-118"><a href="#cb3-118" tabindex="-1"></a><span class="co">#&gt;          Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental </span></span>
<span id="cb3-119"><a href="#cb3-119" tabindex="-1"></a><span class="co">#&gt;           0.6959653           0.9631248           0.9536550           1.0219137 </span></span>
<span id="cb3-120"><a href="#cb3-120" tabindex="-1"></a><span class="co">#&gt;   Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla </span></span>
<span id="cb3-121"><a href="#cb3-121" tabindex="-1"></a><span class="co">#&gt;           1.1450871           1.5126919           1.4086759           1.9274341 </span></span>
<span id="cb3-122"><a href="#cb3-122" tabindex="-1"></a><span class="co">#&gt;       Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 </span></span>
<span id="cb3-123"><a href="#cb3-123" tabindex="-1"></a><span class="co">#&gt;           2.1162922           0.8104003           0.8940698           1.1256465 </span></span>
<span id="cb3-124"><a href="#cb3-124" tabindex="-1"></a><span class="co">#&gt;    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa </span></span>
<span id="cb3-125"><a href="#cb3-125" tabindex="-1"></a><span class="co">#&gt;           0.8116058           1.3990137           2.5092005           2.5237035 </span></span>
<span id="cb3-126"><a href="#cb3-126" tabindex="-1"></a><span class="co">#&gt;      Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E </span></span>
<span id="cb3-127"><a href="#cb3-127" tabindex="-1"></a><span class="co">#&gt;           3.8192280           2.1476872           2.6971058           1.5431769</span></span></code></pre></div>
<p>Example Description: This example demonstrates the use of the
perform_bagging function to apply three types of regression models
(Ridge, Lasso, and Elastic Net) with the addition of bagging to enhance
model stability and accuracy. The mtcars dataset, which includes various
measurements related to car performance and design, is used here.</p>
<p>Steps and Parameters: Loading Data: The mtcars dataset is loaded.
This dataset is commonly used for examples in regression analysis.
Setting Up Response and Predictor Variables: Response Variable y: mpg
(miles per gallon), a continuous variable indicating the fuel
efficiency. Predictor Variables X: All other columns in mtcars,
excluding mpg, treated as predictors. The data is converted to a matrix
format as required by the glmnet function used in perform_bagging.
Performing Bagging with Different Regression Models: Ridge Regression:
Here, alpha is set to 0, indicating no L1 penalty (pure ridge
regression). Lasso Regression: Here, alpha is set to 1, indicating no L2
penalty (pure lasso regression). Elastic Net Regression: Here, alpha is
set to 0.5, blending both L1 and L2 penalties. Number of Bootstrap
Samples: For each model type, R is set to 50, indicating that the
function will perform bagging using 50 bootstrap samples of the
dataset.</p>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
